<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      #botonSubmit {
        background-color: #04aa6d;
        color: white;
        display: block;
      }

      .container {
        background-color: #f1f1f1;
        padding: 20px;
      }

      #message_nom {
        display: block;
        background: #f1f1f1;
        color: #000;
        position: relative;
        padding: 10px 10px 10px 50px;
        margin-top: 5px;
      }

      #message_nom p {
        padding: 5px 25px;
        font-size: 18px;
      }

      #message_passwd {
        display: block;
        background: #f1f1f1;
        color: #000;
        position: relative;
        padding: 10px 10px 10px 50px;
        margin-top: 5px;
      }

      #message_passwd p {
        padding: 5px 25px;
        font-size: 18px;
      }

      .valid {
        color: green;
      }

      .valid:before {
        position: relative;
        left: -20px;
        content: "✔";
      }

      .invalid {
        color: red;
      }

      .invalid:before {
        position: relative;
        left: -20px;
        content: "✖";
      }
    </style>
  </head>

  <body>
    <h3>Validació contrasenya</h3>

    <form action="enunciat_pelicules.html">
      <div class="container">
        <label for="usrname">Nom</label><br />
        <input
          type="text"
          id="usrname"
          name="usrname"
          title="Ha de tenir una @"
          required
          required
        /><br /><br />

        <label for="psw">Contrasenya</label><br />
        <input
          type="password"
          id="psw"
          name="psw"
          pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
          title="Ha de tenir una minúscula, una majúscula, un número i almenys vuit caràcters"
          required
        />
        <br /><br />
        <input
          type="checkbox"
          id="mostrar"
          onclick="mostrarContrasenya()"
        />Mostrar contrasenya
      </div>

      <div id="message_nom">
        <h3>El nom ha de tenir:</h3>
        <p id="arroba" class="invalid">Una @</p>
      </div>

      <div id="message_passwd">
        <h3>La contrasenya ha de tenir:</h3>
        <p id="letter" class="invalid">Una lletra <b>minúscula</b></p>
        <p id="capital" class="invalid">Una lletra <b>majúscula</b></p>
        <p id="number" class="invalid">Un <b>número</b></p>
        <p id="length" class="invalid">Mínim <b>8 caràcters</b></p>
      </div>

      <br /><br /><input type="submit" value="Enviar" id="botonSubmit" />
    </form>

    <script>
      /////////////////////// Fiqueu el vostre codi aquí ////////////////////////
      var myInputUsr = document.getElementById("usrname");
      var myInputPsw = document.getElementById("psw");
      var arroba = document.getElementById("arroba");
      var letter = document.getElementById("letter");
      var capital = document.getElementById("capital");
      var number = document.getElementById("number");
      var length = document.getElementById("length");
      var submitBoto = document.getElementById("botonSubmit");

      var pswOK = false;
      var UsrOK = false;

      //Ocultem boto submit
      document.getElementById("botonSubmit").style.display = "none";

      //Si l'usuari fa click a mostrar contrasenya, el format de contrasenya passara a text, i es veura en text clar, si ho torna a fer pasara a password
      function mostrarContrasenya() {
        var x = document.getElementById("psw");
        if (x.type === "password") {
          x.type = "text";
        } else {
          x.type = "password";
        }
      }
      //Si l'usuari interactua amb el input del nom d'usuari o contrasenya, es veuran els missatges de el que ha de contenir cada apartartat
      myInputUsr.onfocus = function () {
        document.getElementById("message_nom").style.display = "block";
      };
      myInputUsr.onblur = function () {
        document.getElementById("message_nom").style.display = "none";
      };
      myInputPsw.onfocus = function () {
        document.getElementById("message_passwd").style.display = "block";
      };
      myInputPsw.onblur = function () {
        document.getElementById("message_passwd").style.display = "none";
      };

      //Validació del camp usuari per tal de comprovar que conté un @
      myInputUsr.onkeyup = function () {
        var necessaryChars = "@";

        if (myInputUsr.value.match(necessaryChars)) {
          arroba.classList.remove("invalid");
          arroba.classList.add("valid");
          UsrOK = true;
        } else {
          arroba.classList.remove("valid");
          arroba.classList.add("invalid");
          UsrOK = false;
        }
        submitBoton();
      };

      //Validació dels camps de Password
      myInputPsw.onkeyup = function () {
        var lowerCaseOK = false;
        var upperCaseOK = false;
        var numbersOK = false;
        var lengthOK = false;

        // Validate lowercase letters
        var lowerCaseLetters = /[a-z]/g;
        if (myInputPsw.value.match(lowerCaseLetters)) {
          letter.classList.remove("invalid");
          letter.classList.add("valid");
          lowerCaseOK = true;
        } else {
          letter.classList.remove("valid");
          letter.classList.add("invalid");
          lowerCaseOK = false;
        }

        // Validate capital letters
        var upperCaseLetters = /[A-Z]/g;
        if (myInputPsw.value.match(upperCaseLetters)) {
          capital.classList.remove("invalid");
          capital.classList.add("valid");
          upperCaseOK = true;
        } else {
          capital.classList.remove("valid");
          capital.classList.add("invalid");
          upperCaseOK = false;
        }

        // Validate numbers
        var numbers = /[0-9]/g;
        if (myInputPsw.value.match(numbers)) {
          number.classList.remove("invalid");
          number.classList.add("valid");
          numbersOK = true;
        } else {
          number.classList.remove("valid");
          number.classList.add("invalid");
          numbersOK = false;
        }

        // Validate length
        if (myInputPsw.value.length >= 8) {
          length.classList.remove("invalid");
          length.classList.add("valid");
          lengthOK = true;
        } else {
          length.classList.remove("valid");
          length.classList.add("invalid");
          lengthOK = false;
        }

        if (lowerCaseOK && upperCaseOK && numbersOK && lengthOK) {
          pswOK = true;
        } else {
          pswOK = false;
        }
        submitBoton();
      };

      //Activació o desactivació del submit. Només s'activa si els camps de contrasenya i usuari son correctes
      function submitBoton() {
        if (UsrOK && pswOK) {
          document.getElementById("botonSubmit").style.display = "block";
        } else {
          document.getElementById("botonSubmit").style.display = "none";
        }
      }

      ///////////////////////////////////////////////////////////////////////////
    </script>
  </body>
</html>
